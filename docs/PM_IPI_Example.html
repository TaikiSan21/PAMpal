---
layout: default
---

<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>PM_IPI_Example.knit</title>

<script src="site_libs/header-attrs-2.8/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="header">




</div>


<div id="pm-ipi-in-cepstrograms" class="section level1">
<h1>PM IPI in Cepstrograms</h1>
<p>A quick intro to using <code>calculateAverageSpectra</code> to investigate sperm whale IPI. First just loading in our data. Has this data been decimated? If so, supply that value to the <code>sr_hz</code> argument in place of <code>'auto'</code>.</p>
<pre class="r"><code>db &lt;- &#39;../Data/LowFilter/Drift_7_ReRun_500Hz_Filter.sqlite3&#39;
bin &lt;- &#39;../Data/LowFilter/Binaries/&#39;

pps &lt;- PAMpalSettings(db, bin, sr_hz=&#39;auto&#39;, filterfrom_khz=1, filterto_khz=NULL, winLen_sec=.0025)
data &lt;- processPgDetections(pps, mode=&#39;db&#39;, id=&#39;PM_IPI&#39;)</code></pre>
<p>Then we can just use the same <code>calculateAverageSpectra</code> function with a new option <code>mode='ceps'</code> to plot an average cepstrogram.</p>
<pre class="r"><code># print(data)
par(mfrow=c(2,1))
calculateAverageSpectra(data, 1, mode=&#39;ceps&#39;, wl=1024)</code></pre>
<p><img src="PM_IPI_Example_files/figure-html/unnamed-chunk-3-1.png" width="480" /></p>
<pre class="r"><code>par(mfrow=c(1,1))</code></pre>
<p>We can also plot multiple events at once, and we can selectively choose which of the two plots it creates to show at a time. Separate events are separated by a black line within the concatenated spectrogram</p>
<pre class="r"><code># Do events 1:3 at same time, and only show the concatenated plot
calculateAverageSpectra(data, 1:3, mode=&#39;ceps&#39;, wl=1024, plot=c(TRUE, FALSE))</code></pre>
<p><img src="PM_IPI_Example_files/figure-html/unnamed-chunk-4-1.png" width="480" /></p>
<p>If your sample rate is large, you either need to greatly increase your window length, or use the new <code>decimate</code> option which will reduce the sample rate by an integer amount to get cepstrum data to be useful.</p>
<pre class="r"><code># Try increasing window length by 4x
calculateAverageSpectra(data, 1:3, mode=&#39;ceps&#39;, wl=4096, plot=c(T,F))</code></pre>
<p><img src="PM_IPI_Example_files/figure-html/unnamed-chunk-5-1.png" width="480" /></p>
<pre class="r"><code># Or decimating
calculateAverageSpectra(data, 1:3, mode=&#39;ceps&#39;, wl=1024, decimate=4, plot=c(T,F))</code></pre>
<p><img src="PM_IPI_Example_files/figure-html/unnamed-chunk-5-2.png" width="480" /></p>
<p>The IPI values we are looking for are in the range of 5-10ms, so we want to decimate until the Y-axis is around 15-20ms to really get values in this range to show up.</p>
<pre class="r"><code># Try decimating by 8
calculateAverageSpectra(data, 1:3, mode=&#39;ceps&#39;, wl=1024, decimate=8, plot=c(T,F))</code></pre>
<p><img src="PM_IPI_Example_files/figure-html/unnamed-chunk-6-1.png" width="480" /></p>
<pre class="r"><code># Increasing to 10 looks even better
calculateAverageSpectra(data, 1:3, mode=&#39;ceps&#39;, wl=1024, decimate=10, plot=c(T, F))</code></pre>
<p><img src="PM_IPI_Example_files/figure-html/unnamed-chunk-6-2.png" width="480" /></p>
<p>In those last couple plots we can clearly see some lines showing up in our range of interest (5-10ms), so now that we’ve dialed in the decimation settings we can take a look at the average spectra to see if that is showing up as a peak</p>
<pre class="r"><code># Event 1
calculateAverageSpectra(data, 1, mode=&#39;ceps&#39;, wl=1024, decimate=10, plot=c(F,T))</code></pre>
<p><img src="PM_IPI_Example_files/figure-html/unnamed-chunk-7-1.png" width="480" /></p>
<pre class="r"><code># Event 2
calculateAverageSpectra(data, 2, mode=&#39;ceps&#39;, wl=1024, decimate=10, plot=c(F,T))</code></pre>
<p><img src="PM_IPI_Example_files/figure-html/unnamed-chunk-7-2.png" width="480" /></p>
<pre class="r"><code># Event 3
calculateAverageSpectra(data, 3, mode=&#39;ceps&#39;, wl=1024, decimate=10, plot=c(F,T))</code></pre>
<p><img src="PM_IPI_Example_files/figure-html/unnamed-chunk-7-3.png" width="480" /></p>
<p>The peaks in events 1 &amp; 3 are definitely visible on the averages, although because the the lower cepstral values are so large in magnitude it is harder to see them. Maybe if this looks promising we could create plots with those lower values completely filtered out, just looking at IPIs that are of interest for our sperm whales?</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
